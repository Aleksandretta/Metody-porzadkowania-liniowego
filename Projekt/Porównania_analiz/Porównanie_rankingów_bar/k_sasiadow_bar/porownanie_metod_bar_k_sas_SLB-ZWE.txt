import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

# Wczytaj dane z pliku Excela
df = pd.read_excel('porownanie_metod_bez_pozycyjnej.xlsx', sheet_name='k_sasiadow')

# Wybierz nazwy państw oraz rankingi dla wszystkich metod
countries = df['Country'][149:186]  # Wybieramy pierwsze 50 krajów
rankings = {
    'TOPSIS': df['Rank_topsis_k_sasiadow'][149:186],
    'TOPSIS unitaryzacja': df['Rank_topsis_unitaryzacja_k_sasiadow'][149:186],
    'Hellwig': df['Rank_hellwig_k_sasiadow'][149:186],
    'SSW': df['Rank_ssw_k_sasiadow'][149:186],
    'NOWAK': df['Rank_nowak_k_sasiadow'][149:186],
    'MUZ': df['Rank_muz_k_sasiadow'][149:186],
    'STRAHL': df['Rank_strahl_k_sasiadow'][149:186]
}

# Tworzenie wykresu
fig, ax = plt.subplots(figsize=(10, 6))

# Ustawienie pozycji słupków
bar_width = 0.1
positions = np.arange(len(countries))

# Dodawanie słupków dla każdego kraju i każdej metody
for i, (method, ranking) in enumerate(rankings.items()):
    ax.bar(positions + i * bar_width, ranking, width=bar_width, label=method)

# Ustawienie nazw krajów jako etykiet osi x
ax.set_xticks(positions + 2 * bar_width / 2)
ax.set_xticklabels(countries, rotation=45, ha='right', fontsize=8)

# Dodanie tytułu i legendy
ax.set_title('Porównanie rankingów państw SLB-ZWE dla danych przybliżanych metodą k-sąsiadów')
ax.legend()

# Pokaż wykres
plt.tight_layout()
plt.savefig('porownanie_metod_bar_k_sas_SLB-ZWE.jpg', dpi=600)
plt.close()
